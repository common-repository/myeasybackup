var ajax_ro_item="";function createRequestObject(){var a;a=window.XMLHttpRequest?new XMLHttpRequest():new ActiveXObject("Microsoft.XMLHTTP");return a}var http=createRequestObject();function sndReq(e,a,d){if(ajax_ro_item!=""){setTimeout('sndReq("'+e+'","'+a+'","'+d+'");',500);return}ajax_ro_item=e;var b=ajaxURL;var f="action="+e+"&tag="+a+"&parms="+d;var c="";switch(c){case"production":http.open("get",b+"?"+f);break;default:http.open("post",b,true);http.setRequestHeader("Content-type","application/x-www-form-urlencoded")}http.onreadystatechange=handleResponse;switch(c){case"production":http.send(null);break;default:http.send(f)}}function handleResponse(){if(http.readyState==4){var response=http.responseText;var blocks=new Array();var update=new Array();var cmd=new Array();var i=0;var splitter_tag="|-ajax-tag-|";var splitter_block="|-ajax-block-|";var splitter_cmd="|-ajax-cmd-|";if(response==""||typeof response=="undefined"||response==null){return}var newdiv=document.createElement("ajax");if(response.indexOf(splitter_block)!=-1){blocks=response.split(splitter_block);update=blocks[0].split(splitter_tag);cmd=blocks[1].split(splitter_cmd)}else{update=response.split(splitter_tag);cmd=0}newdiv.innerHTML=update[1];var ready=document.getElementById(update[0]);if(typeof ready!="undefined"&&ready!=null){document.getElementById(update[0]).innerHTML="";document.getElementById(update[0]).appendChild(newdiv)}else{if(typeof update[0]!="undefined"&&typeof update[1]!="undefined"&&update[0]!=""&&update[1]!=""){var elId=update[0];var elCont=update[1].replace(/\"/g,"@");setTimeout('delayUpdate("'+elId+'","'+elCont+'")',200)}}if(cmd!=0){var t=cmd.length;for(i=0;i<t;i++){eval(cmd[i])}}ajax_ro_item=""}}function delayUpdate(b,c){var a=document.getElementById(b);if(typeof a!="undefined"&&a!=null){var c=c.replace(/@/g,'"');setTimeout('document.getElementById("'+b+"\").innerHTML = '';var newdiv = document.createElement('ajax');newdiv.innerHTML = '"+c+"';document.getElementById(\""+b+'").appendChild(newdiv);',50)}};